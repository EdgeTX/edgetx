# Configuration for git-cliff changelog generation
# https://git-cliff.org/docs/configuration

[changelog]
header = ""
body = """
{% for group, commits in commits | group_by(attribute="group") -%}
{% if group == "ğŸš€ Features" -%}
### {{ group }}
{% set commits_by_scope = commits | group_by(attribute="scope") -%}
{% if commits_by_scope.firmware is defined or commits_by_scope.fw is defined -%}
#### ğŸ® Firmware
{% if commits_by_scope.firmware is defined -%}{% for commit in commits_by_scope.firmware -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.fw is defined -%}{% for commit in commits_by_scope.fw -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% if commits_by_scope.bw is defined -%}
#### ğŸ–¥ï¸ Black & White Radio
{% for commit in commits_by_scope.bw -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}
{% endif -%}
{% if commits_by_scope.color is defined or commits_by_scope.colour is defined -%}
#### ğŸ¨ Color LCD Radio
{% if commits_by_scope.color is defined -%}{% for commit in commits_by_scope.color -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.colour is defined -%}{% for commit in commits_by_scope.colour -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% if commits_by_scope.cpn is defined or commits_by_scope.companion is defined -%}
#### ğŸ’» Companion
{% if commits_by_scope.cpn is defined -%}{% for commit in commits_by_scope.cpn -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.companion is defined -%}{% for commit in commits_by_scope.companion -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% set_global has_other = false -%}
{% for commit in commits -%}{% if commit.scope != "firmware" and commit.scope != "fw" and commit.scope != "bw" and commit.scope != "color" and commit.scope != "colour" and commit.scope != "cpn" and commit.scope != "companion" -%}{% set_global has_other = true -%}{% endif -%}{% endfor -%}
{% if has_other -%}
#### ğŸ“¦ Other
{% for commit in commits -%}{% if commit.scope != "firmware" and commit.scope != "fw" and commit.scope != "bw" and commit.scope != "color" and commit.scope != "colour" and commit.scope != "cpn" and commit.scope != "companion" -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endif -%}{% endfor -%}
{% endif -%}
{% endif -%}
{% endfor -%}

{% for group, commits in commits | group_by(attribute="group") -%}
{% if group == "ğŸ› Bug Fixes" -%}
### {{ group }}
{% set commits_by_scope = commits | group_by(attribute="scope") -%}
{% if commits_by_scope.firmware is defined or commits_by_scope.fw is defined -%}
#### ğŸ® Firmware
{% if commits_by_scope.firmware is defined -%}{% for commit in commits_by_scope.firmware -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.fw is defined -%}{% for commit in commits_by_scope.fw -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% if commits_by_scope.bw is defined -%}
#### ğŸ–¥ï¸ Black & White Radio
{% for commit in commits_by_scope.bw -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}
{% endif -%}
{% if commits_by_scope.color is defined or commits_by_scope.colour is defined -%}
#### ğŸ¨ Color LCD Radio
{% if commits_by_scope.color is defined -%}{% for commit in commits_by_scope.color -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.colour is defined -%}{% for commit in commits_by_scope.colour -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% if commits_by_scope.cpn is defined or commits_by_scope.companion is defined -%}
#### ğŸ’» Companion
{% if commits_by_scope.cpn is defined -%}{% for commit in commits_by_scope.cpn -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.companion is defined -%}{% for commit in commits_by_scope.companion -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% set_global has_other = false -%}
{% for commit in commits -%}{% if commit.scope != "firmware" and commit.scope != "fw" and commit.scope != "bw" and commit.scope != "color" and commit.scope != "colour" and commit.scope != "cpn" and commit.scope != "companion" -%}{% set_global has_other = true -%}{% endif -%}{% endfor -%}
{% if has_other -%}
#### ğŸ“¦ Other
{% for commit in commits -%}{% if commit.scope != "firmware" and commit.scope != "fw" and commit.scope != "bw" and commit.scope != "color" and commit.scope != "colour" and commit.scope != "cpn" and commit.scope != "companion" -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endif -%}{% endfor -%}
{% endif -%}
{% endif -%}
{% endfor -%}

{% for group, commits in commits | group_by(attribute="group") -%}
{% if group != "ğŸš€ Features" and group != "ğŸ› Bug Fixes" and group != "ğŸ“¦ Other" -%}
### {{ group }}
{% set commits_by_scope = commits | group_by(attribute="scope") -%}
{% if commits_by_scope.firmware is defined or commits_by_scope.fw is defined -%}
#### ğŸ® Firmware
{% if commits_by_scope.firmware is defined -%}{% for commit in commits_by_scope.firmware -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.fw is defined -%}{% for commit in commits_by_scope.fw -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% if commits_by_scope.bw is defined -%}
#### ğŸ–¥ï¸ Black & White Radio
{% for commit in commits_by_scope.bw -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}
{% endif -%}
{% if commits_by_scope.color is defined or commits_by_scope.colour is defined -%}
#### ğŸ¨ Color LCD Radio
{% if commits_by_scope.color is defined -%}{% for commit in commits_by_scope.color -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.colour is defined -%}{% for commit in commits_by_scope.colour -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% if commits_by_scope.cpn is defined or commits_by_scope.companion is defined -%}
#### ğŸ’» Companion
{% if commits_by_scope.cpn is defined -%}{% for commit in commits_by_scope.cpn -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.companion is defined -%}{% for commit in commits_by_scope.companion -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% set_global has_other = false -%}
{% for commit in commits -%}{% if commit.scope != "firmware" and commit.scope != "fw" and commit.scope != "bw" and commit.scope != "color" and commit.scope != "colour" and commit.scope != "cpn" and commit.scope != "companion" -%}{% set_global has_other = true -%}{% endif -%}{% endfor -%}
{% if has_other -%}
#### ğŸ“¦ Other
{% for commit in commits -%}{% if commit.scope != "firmware" and commit.scope != "fw" and commit.scope != "bw" and commit.scope != "color" and commit.scope != "colour" and commit.scope != "cpn" and commit.scope != "companion" -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endif -%}{% endfor -%}
{% endif -%}
{% endif -%}
{% endfor -%}

{% for group, commits in commits | group_by(attribute="group") -%}
{% if group == "ğŸ“¦ Other" -%}
### {{ group }}
{% set commits_by_scope = commits | group_by(attribute="scope") -%}
{% if commits_by_scope.firmware is defined or commits_by_scope.fw is defined -%}
#### ğŸ® Firmware
{% if commits_by_scope.firmware is defined -%}{% for commit in commits_by_scope.firmware -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.fw is defined -%}{% for commit in commits_by_scope.fw -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% if commits_by_scope.bw is defined -%}
#### ğŸ–¥ï¸ Black & White Radio
{% for commit in commits_by_scope.bw -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}
{% endif -%}
{% if commits_by_scope.color is defined or commits_by_scope.colour is defined -%}
#### ğŸ¨ Color LCD Radio
{% if commits_by_scope.color is defined -%}{% for commit in commits_by_scope.color -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.colour is defined -%}{% for commit in commits_by_scope.colour -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% if commits_by_scope.cpn is defined or commits_by_scope.companion is defined -%}
#### ğŸ’» Companion
{% if commits_by_scope.cpn is defined -%}{% for commit in commits_by_scope.cpn -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% if commits_by_scope.companion is defined -%}{% for commit in commits_by_scope.companion -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endfor -%}{% endif -%}
{% endif -%}
{% set_global has_other = false -%}
{% for commit in commits -%}{% if commit.scope != "firmware" and commit.scope != "fw" and commit.scope != "bw" and commit.scope != "color" and commit.scope != "colour" and commit.scope != "cpn" and commit.scope != "companion" -%}{% set_global has_other = true -%}{% endif -%}{% endfor -%}
{% if has_other -%}
#### ğŸ“¦ Other
{% for commit in commits -%}{% if commit.scope != "firmware" and commit.scope != "fw" and commit.scope != "bw" and commit.scope != "color" and commit.scope != "colour" and commit.scope != "cpn" and commit.scope != "companion" -%}
- {{ commit.message | split(pat="\\n") | first | trim }}
{% endif -%}{% endfor -%}
{% endif -%}
{% endif -%}
{% endfor -%}
"""
trim = true

[git]
conventional_commits = true
filter_unconventional = false

# Only look for nightly, release and rc tags
tag_pattern = "^(nightly|v[0-9]+\\.[0-9]+\\.[0-9]+(-rc[0-9]+)?)$"

# Ensures it looks at the branch structure
topo_order = true

# Repect the nearest tag on current branch
use_branch_tags = true

# Ensure it sorts from the tag forward
sort_commits = "oldest"

# Commit parsers - order matters! More specific patterns first
commit_parsers = [
  # Type-based categorization (top-level headings)
  { message = "^feat", group = "ğŸš€ Features" },
  { message = "^fix", group = "ğŸ› Bug Fixes" },
  { message = "^docs?", group = "ğŸ“ Documentation" },
  { message = "^perf", group = "âš¡ Performance" },
  { message = "^refactor", group = "ğŸ”¨ Refactoring" },
  { message = "^style", group = "ğŸ¨ Style" },
  { message = "^test", group = "ğŸ§ª Tests" },
  { message = "^chore", group = "ğŸ§¹ Chores" },
  { message = "^ci", group = "ğŸ”§ CI/CD" },

  # Everything else
  { body = ".*", group = "ğŸ“¦ Other" },
]
